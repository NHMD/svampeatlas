<div ng-include="'components/navbar/navbar.html'"></div>
<div class="container">

<div class="row" ng-controller="TaxonTabsCtrl" ng-include="'app/taxontabs/taxontabs.html'">	
	
</div>	
			<div class="row">
				<div class="panel-group" role="tablist" aria-multiselectable="false" start-collapsed="true" ng-model="extendedSearchIsOn" bs-collapse>
			    	  <!-- ########################################-->
			    	  <div class="panel panel-default">
			    	    <div class="panel-heading" role="tab">
			    	      <h4 class="panel-title">
			    	        <a bs-collapse-toggle>
			    	       <i class="fa fa-search"></i> {{'Extended search' | translate}}
			    	        </a>
			    	      </h4>
			    	    </div>
			    	    <div class="panel-collapse" role="tabpanel" bs-collapse-target>
			    	      <div class="panel-body">
							  <div class="col-md-12" ng-show="!checkboxes.OrphantTaxa">
	
							  	
		
							  		
		
							  	<p translate class="md-title">Find species, varietes and forms under selected higher taxa:</p>
	
							      <md-chips ng-model="selectedHigherTaxa" md-autocomplete-snap md-require-match="true">
	
							        <md-autocomplete
							  	  	md-min-length="3"
							  		md-no-cache="true"
							            md-selected-item="selectedItem"
							            md-search-text="searchText"
							            md-items="item in querySearch(searchText)"
							            md-item-text="item.FullName"
							            placeholder="{{'Enter higher taxon' | translate}}">
							          <span md-highlight-text="searchText">{{item.FullName}}</span>
							        </md-autocomplete>
							        <md-chip-template>
							          <span>
							            <strong>{{$chip.FullName}}</strong>
         
							          </span>
							        </md-chip-template>
							      </md-chips>
							 
							 
							 
							  <div class="taxonomy-query-section">
							  	
							      <md-chips ng-model="attributeConditions" ng-show="attributeConditions.length > 0" readonly="false">
							           <md-chip-template>
							             <strong>{{$chip.readable}}</strong>
							           </md-chip-template>
							         </md-chips>
							   <md-content flex layout-padding>	
							  <p  class="md-title taxonomy-query-section-header">{{'Add search terms on attributes' | translate}}:</p>

							  <div layout layout-sm="column">

	
							          <md-input-container>
							             <label>{{'Attribute name' | translate}}</label>
							             <md-select ng-model="attributequery.selectedAttribute">
							               <md-option ng-repeat="(key, value) in taxonattributes" value="{{key}}">
							                 {{key}}
							               </md-option>
							             </md-select>
							           </md-input-container>
							          <md-input-container  ng-if="getAttributeType(attributequery.selectedAttribute) !== 'boolean' && attributequery.selectedAttribute !== undefined">
							             <label>Operator</label>
							             <md-select ng-model="attributequery.selectedOperator">
							               <md-option ng-repeat="operator in operators" value="{{operator}}">
							                 {{operator}}
							               </md-option>
							             </md-select>
							           </md-input-container>
							           <md-input-container  ng-if="getAttributeType(attributequery.selectedAttribute) === 'text' || getAttributeType(attributequery.selectedAttribute) === 'number'">
							  			<label>Query</label>
							  			      <input ng-model="attributequery.value" type="text">
							            </md-input-container>
							           <md-input-container  ng-if="getAttributeType(attributequery.selectedAttribute) === 'date'">
							  			<label>Date</label>
							  			      <input ng-model="attributequery.value" type="text" ng-model="selectedDate" data-container="body" data-date-format="yyyy-MM-dd" name="date" autoclose="0" bs-datepicker>
							            </md-input-container>
		

							  		  <md-input-container ng-if=" getAttributeType(attributequery.selectedAttribute) === 'boolean'">
							  	<md-switch  ng-model="attributequery.value" aria-label="{{attributequery.selectedAttribute}} checked">
	
	          
							  	        </md-switch>
							  </md-input-container>

							  		  <md-input-container ng-if="attributeQueryIsValid()">
							  	<md-button class="md-raised md-primary" ng-click="addCondition()">Add condition</md-button>
							  </md-input-container>
							   </md-content>
							  </div>
							  
							  <p  class="md-title taxonomy-query-section-header">{{'Search redlist categories' | translate}}:</p>
						     
							   <div layout layout-sm="column">
 							      <md-switch class="md-raised md-primary" ng-repeat="category in redlistCategories" ng-model="selectedRedListCategories[category.status]">{{category.status}}</md-switch>
								  </div>
								  
							  <p  class="md-title taxonomy-query-section-header">{{'Search tags' | translate}}:</p>
							   <div layout layout-sm="column">
 							      <md-chips ng-model="selectedTags" md-autocomplete-snap md-require-match="true">
	
 							        <md-autocomplete
 							  	  	md-min-length="3"
 							  		md-no-cache="true"
 							            md-selected-item="selectedTag"
 							            md-search-text="searchTagText"
 							            md-items="item in tagSearch(searchTagText)"
 							            md-item-text="item.tagname"
 							            placeholder="{{'Enter tags' | translate}}">
 							          <span md-highlight-text="searchTagText">{{item.tagname}}</span>
 							        </md-autocomplete>
 							        <md-chip-template>
 							          <span>
 							            <strong>{{$chip.tagname}}</strong>
         
 							          </span>
 							        </md-chip-template>
 							      </md-chips>
								  </div>  
							  </div>
								
			    	      </div>
			    	    </div>
			    	  </div>
			    	  <!-- ########################################-->
				  </div>
  
 </div> 

			
<div class="row"><div class="col-md-12">
	<md-switch class="col-md-2" ng-model="checkboxes.acceptedTaxaOnly" aria-label="Only accepted taxa" >
	         {{ 'Omit synonyms' | translate}}
	        </md-switch>
			
	<md-switch  class="col-md-2" ng-model="checkboxes.PresentInDK" aria-label="Only DK taxa">
	{{ 'Only DK taxa' | translate}}
	          
	        </md-switch>
	<md-switch  class="col-md-3" ng-model="checkboxes.OrphantTaxa" aria-label="Only DK taxa">
	{{ 'Find orphant taxa' | translate}}     
	        </md-switch>
			
<div class="col-md-4"><h3 class="md-headline pull-right">{{'Found' | translate}} {{taxonCount}} taxa</h3></div>
<md-progress-linear class="col-md-12" md-mode="indeterminate" ng-show="isLoading"></md-progress-linear>
<table st-persist="taxon_search_table" class="table taxonomy-table" st-pipe="callServer" st-table="displayed">
	<thead>
	<tr>
		<th st-sort="_id" st-ratio="10">DkIndexNr</th>
		<th st-sort="FullName" st-ratio="40" translate>Full name</th>
		<th st-sort="TaxonName" translate>Epithet</th>
		<th st-sort="RankName" st-ratio="10" translate>Taxon rank</th>
		<th st-sort="attributes.DKnavn" translate>Dansk navn</th>
	</tr>
	<tr>
		<th st-ratio="10"><input class="form-control" st-search="_id" ></th>
		<th st-ratio="40"><input class="form-control" st-search="FullName" ></th>
		<th><input class="form-control" st-search="TaxonName"></th>
		<th st-ratio="10"><input class="form-control" st-search="RankName"></th>
		<th><input class="form-control" st-search="attributes.DKnavn"></th>
	</tr>
	</thead>
	<tbody ng-show="!isLoading">
	<tr ng-repeat="row in displayed">
		<td st-ratio="10">{{row._id}}</td>
		<td st-ratio="40"><a href="/taxonbase/taxon/{{row._id}}">{{row.FullName}}</a> <a href="/taxonbase/taxonbooklayout/{{row._id}}"><i class="fa fa-book"></i></a>
		</td>
		<td>{{row.TaxonName}}</td>
		<td st-ratio="10">{{row.RankName}}</td>
		<td>{{row.attributes.DKnavn}}</td>
	</tr>
	</tbody>
	<tbody ng-show="isLoading">
	<tr>
		<td colspan="4" class="text-center">Loading ... </td>
	</tr>
	</tbody>
	<tfoot>
	<tr>
		<td class="text-center" st-pagination="" st-displayed-pages="paginationPages" st-items-by-page="50" colspan="4">
		</td>
	</tr>
	</tfoot>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="col-md-12">

<div ng-include="'components/footer/footer.html'"></div>
</div>


